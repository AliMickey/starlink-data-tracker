{% extends 'builders/base.html' %}

{% block title %}Starlink Firmware ~ List{% endblock %}

{% block scriptsHead %}
  <link href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css" rel="stylesheet">    
  <script>
    $(document).ready(function() {
        var table = $('#dataTable').DataTable({
            "searching": true,
            "ordering": true,
            "order": [0, "dsc"],
            "paging":  true,
            "pagingType": "simple",
            "lengthMenu": [ 10, 25, 50, 100 ],
            "info": true,
            "stateSave": false,
            buttons: [ 'copy', 'csv', 'excel' ]
        });
        $('#tableSearch').keyup(function(){ 
            var input = $(this).val();
            // Hide all rows
            $('#dataTable tbody tr').hide();
            // Show each row that contains the input
            var len = $('table tbody td:nth-child(1):contains("' + input + '")').length;
            if(len > 0){
            $('#dataTable tbody td:contains("' + input + '")').each(function(){
                $(this).closest('tr').show();
            });
            };
        });
    });
  </script> 
{% endblock %}

{% block content %}
  <div class="col-8 text-center">
    <p class="fs-1 fw-bold">{{ listType|capitalize }} Firmware List <img src="{{ url_for('static', filename='thumbnails/'+listType|lower+'.png') }}" width="125px"></p>
    {% if g.user %}
      <a type="button" href="{{ url_for('firmware.listAdmin', listType=listType) }}">Admin View</a>
    {% endif %}
    <table class="table table-striped table-bordered" id="dataTable">
      <thead>
        <tr>
          <th>Added (UTC)</th>
          <th>Version</th>
          <th>Discussion</th>
        </tr>
      </thead>
      <tbody>
        {% for id, details in listDict.items() %}
        <tr>
          <td>{{ details['dateAdded'] }} <p hidden>{{ details['id'] }}</p></td>
          <td>
            {% if listType == "dishy" %}
              <tt><b>{{ details['version'][:8] }}</b>{{ details['version'][8:] }}</tt>
            {% else %}
              {{ details['version']}}
            {% endif %}
          </td>
          <td>
            {% if details['reddit'] %}
              <a href="{{ details['reddit'] }}" target="_blank"><img src="{{ url_for('static', filename='links/reddit.png') }}" width="30px"></a></td>
            {% else %}
              Not Provided
            {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}

{% block scriptsBody %}
  <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
{% endblock %}