{% extends 'builders/base.html' %}

{% block title %}Starlink Firmware{% endblock %}

{% block scriptsHead %}
  <link href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css" rel="stylesheet">    
  <script>
    $(document).ready(function() {
        var table = $('#dataTable').DataTable({
            "searching": true,
            "ordering": true,
            "order": [0, "dsc"],
            "paging":  true,
            "pagingType": "simple",
            "lengthMenu": [ 10, 25, 50, 100 ],
            "info": true,
            "stateSave": false,
            buttons: [ 'copy', 'csv', 'excel' ]
        });
        $('#tableSearch').keyup(function(){ 
            var input = $(this).val();
            // Hide all rows
            $('#dataTable tbody tr').hide();
            // Show each row that contains the input
            var len = $('table tbody td:nth-child(1):contains("' + input + '")').length;
            if(len > 0){
            $('#dataTable tbody td:contains("' + input + '")').each(function(){
                $(this).closest('tr').show();
            });
            };
        });
    });
  </script> 
{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-8 text-center">
    <p class="fs-1 fw-bold">Notes for {{ versionDetails['type']|title }} Firmware</p>
    <a class="fs-5 text-decoration-none" href="{{ url_for('firmware.list', listType=versionDetails['type']) }}">{{ versionDetails['name'] }}</a>
      <table class="table table-striped table-bordered" id="dataTable">
      <thead>
        <tr>
          <th>Date Added</th>
          <th>Note</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><p hidden>9999-12-31</p></td>
          <form method="post" id="addNoteForm">
            <td><input type="text" class="form-control" id="note" name="note" maxLength="300" required></td>
            <td><button type="submit" class="btn btn-primary" name="btn" value="addNote">Add</button></td>
          </form>
        </tr>
        {% for id, details in listDict.items() %}
        <tr>
          <td>{{ details['dateAdded'] }}<p hidden>{{ details['id'] }}</p></td>
          <td>{{ details['note'] }}</td>
          <td><a type="button" class="btn btn-danger" href="#" data-bs-toggle="modal" data-bs-target="#removeNoteModal-{{id}}">Remove</a></td>
        </tr>
        <div class="modal fade" id="removeNoteModal-{{id}}" tabindex="-1" aria-labelledby="RemoveNoteModal" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addWebsiteLongTitle">Delete Note</h5>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete this?</p>
                    <form method="post" id="removeNoteForm">
                        <input type="hidden" name="entryID" value={{id}}></input>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-danger" name="btn" value="removeNote">Delete</button>
                        </div>
                    </form>
                </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

{% block scriptsBody %}
  <script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
{% endblock %}